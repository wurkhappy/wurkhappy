{% extends "../base.html" %}

### Redefine the main block

{% block main %}
<div class ="container">
  <!-- adds background -->
  {% block navigation %}
  {% end %}
  <!-- not sure what below does; no change when i add it -->
  {% block header %}
  {% end %}

  {% block footer %}
  {% end %}
</div>
{% end %}

{% block footer %}
<div id="footer" class="clear">
  <div class="column-one-fourth">
    <h3>Archives</h3>
    <ul>
      <li><a href="">All Client Agreements</a></li>
      <li><a href="">All Vendor Agreements</a></li>
      <li><a href="">All People</a></li>
    </ul>
  </div>
  <div class="column-one-fourth">
    <h3>Section 2</h3>
    <ul>
      <li><a href="#">Links</a></li>
      <li><a href="#">Links</a></li>
      <li><a href="#">Links</a></li>
    </ul>
  </div>
  <div class="column-one-fourth">
    <h3>Section 3</h3>
    <ul>
      <li><a href="#">Links</a></li>
      <li><a href="#">Links</a></li>
      <li><a href="#">Links</a></li>
    </ul>
  </div>
  <div class="column-one-fourth">
    <h3>Section 4</h3>
    <ul>
      <li><a href="#">Links</a></li>
      <li><a href="#">Links</a></li>
      <li><a href="#">Links</a></li>
    </ul>
  </div>
</div>

<div id="copyright" class="clear">
  <p>Powered by Wurk Happy &bull; Copyright &#169; Wurk Happy. All rights reserved.</p>
</div>
{% end %}

{% block navigation %}
<div id="navigation" class="clear">
  <div class="column-one-half">
    <ul class="clear">
      <li><a href="/agreements/with/clients"><strong>Client Agreements</strong></a></li>
      <li><a href="/agreements/with/vendors"><strong>Vendor Agreements</strong></a></li>
      <li><a href="/people"><strong>People</strong></a></li>
    </ul>
  </div>
  <div class="column-one-half">
    <ul id="admin" class="clear">
      <li><a href="/logout">Log Out</a></li>
      <li class="current"><a href="/user/me/account">Account</a></li>
      <li><a href="/user/{{ bag['userID'] }}/preferences">Preferences</a></li>
    </ul>
  </div>
</div>
{% end %}

{% block header %}
<div id="intro" class="clear">
  <div class="column-three-fourth">
    <h1>Account</h1>
  </div>	  
</div>
<div id="internal" class="clear">
  {% for action in bag["actions"] %}
  <ul>
    <li{% if action['name'] == "Personal Details" %} 
	  class="current"
	  {% end %}>
      <!-- how to use re.replace in tornado? -->
	<a href="#{{ action['name'].replace(' ', '_')}}" 
	   class="top"
	   onclick="$('#internal li').removeClass('current');
		    {% for a in bag['actions'] %}
		    $('.{{ a['name'].replace(' ','_') }}').hide();
		    {% end %}
		    $(this).parent('li').addClass('current');
		    $('.{{ action['name'].replace(' ', '_') }}').show();"
	   >
	   <span>{{ action['name'] }}</span></a></li>
  </ul>
  {% end %}
  {% for action in bag['actions'] %}
  <div id="content" class="clear {{ action['name'].replace(' ','_') }}"
       {% if action['name'] != "Personal Details" %}
       style="display : none;"
       {% end %} >

    {% for section in action['sections'] %}

    {% if 'title' in section %}
    <h2> {{ section['title'] }} </h2>    
    {% end %}

    {% if 'table' in section %}
    <div class="data-table"> 
      <table border="0" cellspacing="0" cellpadding="0"> 
	{% for row in section['table'] %}
        <tr> 
	  {% for col in row %}
	  <td{% if 'class' in col %} class="{{ col['class'] }}" {% end %}>
	    {% for entry in col['entries'] %}
	    {% for (tag, params) in entry['tags'] %}
	    <{{ tag }}{% if params %}{% for name in params %} {{ name }}="{{ params[name] }}" {% end %}{% end %}>
	      {% end %} <!--closes tag/param/entry -->
	      {{ entry['value'] }}
	      {% for (tag, params) in reversed(entry['tags']) %}
	      </{{ tag }}>
	    {% end %} <!-- closes tag/param/entry -->
	    {% end %}<!-- closes entry-->
	    </td>
	  {% end %} <!-- closes col -->
        </tr> 
	{% end %} <!-- closes row -->
      </table> 
    </div>
    {% end %} <!-- closes table -->
    {% end %} <!-- closes if-table -->

    <form action="/user/me/account/{{ action['formAction'] }}" method="post">
      {% raw xsrf_form_html() %}
      
      {% if 'radiobuttons' in section %}
      <fieldset>
	{% for (i, radiobutton) in enumerate(section['radiobuttons'], 1) %}
	<label for "{{ radiobutton['label'] }}">
	  <input type="radio" name="{{ radiobutton['name'] }}" 
		 id="{{ radiobutton['label']}}" value="{{ i }}"
		 {% if i==1 %} checked {% end %}>
	  {{ radiobutton['value'] }}
	</label>
	{% end %}
      </fieldset>
      {% end %}

      {% if 'textfields' in section %}
      <fieldset>
	{% for textfield in section['textfields'] %}
    	<label for {{ textfield['name'] }}>{{ textfield['label'] }}</label>
    	<input type="text" value="{{ textfield['value']  }}" 
	       name="{{ textfield['name']  }}" id="" size="50"/>
	{% end %}
      </fieldset>
      {% end %}

      {% if 'fileselectors' in section %}
      <fieldset>
	{% for fileselector in section['fileselectors'] %}
	<label for "">{{ fileselector }}</label><br/>
	<input type="file" class="upload" name="{{ fileselector }}">
	{% end %}
      </fieldset>
      {% end %}
      <fieldset class="submit-buttons">
<<<<<<< HEAD
	<input type="submit" class="single js_send" value="{{ action['submit-button'] }}" />
=======
	<input type="submit" class="single js-replace-action"
	       value="{{ action['submit-button'] }}" />
>>>>>>> ec9fba549e8ca356e71d7be87fc4fce22947f1dc
      </fieldset>
    </form>
  </div>
  {% end %} <!-- closes section -->
</div>
{% end %}

{% block scripts-custom %}
<!-- NOTE : etosch had problems with inner double quotations here usins Python 2.6, Tornado 2.0, and Chrome 13.0.782.112-->
<script src="{{ static_url('scripts/application.js') }}" type="text/javascript" ></script>
<script src="{{ static_url('scripts/libs/jquery-autosuggest-1.3.js') }}" type="text/javascript"></script>
{% end %}
